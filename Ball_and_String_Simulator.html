<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ball and String Simulator</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { color-scheme: light; }
        .glass { background: rgba(255, 255, 255, 0.75); backdrop-filter: blur(10px); }
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: none;
        }
        canvas {
            background-color: white;
            border-radius: 0.5rem;
            border: 2px solid #e2e8f0; /* slate-200 */
        }
        .sim-button {
            padding: 0.75rem 1.25rem;
            border-radius: 0.5rem;
            font-weight: 600;
            font-size: 1.125rem;
            line-height: 1.75rem;
            color: white;
            background-color: #3b82f6; /* blue-500 */
            border: 2px solid #2563eb; /* blue-600 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            transform: translateY(0);
            cursor: pointer;
        }
        .sim-button:hover {
            transform: translateY(-2px);
            background-color: #2563eb; /* blue-600 */
        }
        .sim-button:active {
            transform: translateY(1px);
        }
        .sim-button:disabled {
            background-color: #94a3b8; /* slate-400 */
            border-color: #64748b; /* slate-500 */
            cursor: not-allowed;
            transform: translateY(0);
        }
        #releaseButton {
            background-color: #ef4444; /* red-500 */
            border-color: #dc2626; /* red-600 */
        }
        #releaseButton:hover:enabled {
            background-color: #dc2626; /* red-600 */
        }
        #resetButton {
            background-color: #64748b; /* slate-500 */
            border-color: #475569; /* slate-600 */
        }
        #resetButton:hover:enabled {
            background-color: #475569; /* slate-600 */
        }
        #explainButton {
            background-color: #8b5cf6; /* violet-500 */
            border-color: #7c3aed; /* violet-600 */
        }
        #explainButton:hover:enabled {
            background-color: #7c3aed; /* violet-600 */
        }

        /* Modal Styles */
        #explanationModal {
            display: none; /* Hidden by default */
        }
        /* Simple CSS loading spinner */
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #8b5cf6; /* Violet */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RJQ61GJDVS"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RJQ61GJDVS');
    </script>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50 text-slate-800">
    
    <!-- Header -->
    <header class="max-w-6xl mx-auto px-6 pt-6 pb-4">
        <nav class="flex items-center justify-between">
            <a href="index.html" class="inline-flex items-center gap-2 text-slate-600 hover:text-blue-600 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                <span class="font-medium" data-i18n="nav.back">Back to Home</span>
            </a>
            
            <!-- Language Switcher -->
            <div class="flex gap-2">
                <button onclick="setLanguage('zh')" class="lang-btn px-3 py-1 rounded-lg text-sm font-medium transition hover:bg-blue-100" data-lang="zh">ÁπÅ</button>
                <button onclick="setLanguage('cn')" class="lang-btn px-3 py-1 rounded-lg text-sm font-medium transition hover:bg-blue-100" data-lang="cn">ÁÆÄ</button>
                <button onclick="setLanguage('en')" class="lang-btn px-3 py-1 rounded-lg text-sm font-medium transition hover:bg-blue-100 bg-blue-600 text-white" data-lang="en">EN</button>
            </div>
        </nav>
    </header>

    <div class="w-full max-w-2xl mx-auto px-6 pb-16">
        <div class="glass rounded-3xl p-6 md:p-8 border border-white/60">

        <div class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-800" data-i18n="title">Ball & String Simulator</h1>
            <p class="text-md md:text-lg text-slate-600 mt-2" data-i18n="subtitle">
                Observe the ball's path when the string is released!
            </p>
        </div>

        
        <div class="w-full aspect-square bg-white rounded-lg shadow-lg border-2 border-slate-200">
            <canvas id="ballStringCanvas"></canvas>
        </div>
        
        
        <div class="mt-6 grid grid-cols-2 md:grid-cols-3 items-center justify-center gap-4">
            <button id="releaseButton" class="sim-button" data-i18n="button.release">Release Ball!</button>
            <button id="resetButton" class="sim-button" data-i18n="button.reset">Reset</button>
            <button id="explainButton" class="sim-button col-span-2 md:col-span-1" data-i18n="button.explain">‚ú® Explain the Physics</button>
        </div>

        <div class="mt-4 p-4 bg-slate-100 rounded-lg shadow-inner text-slate-700">
            <p class="text-sm">
                <strong><span class="text-red-600" data-i18n="info.red">Red Arrow</span>:</strong> <span data-i18n="info.red.desc">Centripetal Force (tension in the string)</span>
            </p>
            <p class="text-sm">
                <strong><span class="text-green-600" data-i18n="info.green">Green Arrow</span>:</strong> <span data-i18n="info.green.desc">Tangential Velocity (direction of motion)</span>
            </p>
            <p class="text-sm mt-2" data-i18n="info.watch">
                Watch how the ball continues to move in the direction of the **green arrow** (tangential velocity) at the exact moment of release!
            </p>
        </div>

        <div class="mt-4 text-center">
            <button onclick="openFeedbackForm(event)" class="text-sm text-blue-600 hover:text-blue-800 transition" data-i18n="button.feedback">üìù Send us your feedback</button>
        </div>

        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedbackModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-6">
            <h3 class="text-xl font-bold text-slate-800 mb-4" data-i18n="feedback.title">Send Us Your Feedback</h3>
            <form onsubmit="submitFeedback(event)" class="space-y-4">
                <input type="email" placeholder="Your email" required class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" data-i18n-placeholder="feedback.email">
                <textarea placeholder="Your feedback or suggestions..." rows="4" required class="w-full px-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" data-i18n-placeholder="feedback.message"></textarea>
                <div class="flex gap-3">
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition" data-i18n="feedback.send">Send</button>
                    <button type="button" onclick="closeFeedbackForm()" class="flex-1 bg-slate-200 text-slate-800 py-2 rounded-lg hover:bg-slate-300 transition" data-i18n="feedback.cancel">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Gemini Explanation Modal -->
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg p-6 relative">
            <h3 class="text-2xl font-bold text-slate-800 mb-4">Physics Explanation</h3>
            <div id="modalContent" class="text-slate-700 max-h-[60vh] overflow-y-auto pr-2">
                <!-- Content will be injected by JS -->
            </div>
            <button id="closeModalButton" class="sim-button absolute top-4 right-4 !p-2 !rounded-full !bg-slate-200 !text-slate-600 !border-slate-300">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
    </div>

    <script>
        window.addEventListener('load', () => {
            const canvas = document.getElementById('ballStringCanvas');
            const ctx = canvas.getContext('2d');
            const releaseButton = document.getElementById('releaseButton');
            const resetButton = document.getElementById('resetButton');
            const explainButton = document.getElementById('explainButton');
            const modal = document.getElementById('explanationModal');
            const modalContent = document.getElementById('modalContent');
            const closeModalButton = document.getElementById('closeModalButton');

            // --- State Variables ---
            let angle = Math.PI / 4; 
            let angularVelocity = 0.02; // Slower speed
            let isReleased = false;
            let ball = { x: 0, y: 0, vel: { x: 0, y: 0 } };
            let animFrameId = null;
            let pathHistory = []; // For dotted line
            let circularPathHistory = []; // To store the circular path

            // --- Simulation Parameters ---
            let center, radius, ballRadius;
            let simRunning = true; 

            // --- Helper Function: Resize Canvas ---
            function resizeCanvas() {
                const container = canvas.parentElement;
                const size = container.clientWidth;
                canvas.width = size;
                canvas.height = size;
                
                center = { x: canvas.width / 2, y: canvas.height / 2 };
                radius = canvas.width * 0.35; 
                ballRadius = Math.max(12, canvas.width * 0.03); 
                
                if (!simRunning) { 
                    draw(); 
                }
            }

            // --- Helper Function: Draw an Arrow ---
            function drawArrow(fromX, fromY, toX, toY, color, lineWidth = 3) {
                const headLength = Math.max(8, lineWidth * 3);
                const dx = toX - fromX;
                const dy = toY - fromY;
                const angle = Math.atan2(dy, dx);
                
                ctx.save();
                ctx.strokeStyle = color;
                ctx.fillStyle = color;
                ctx.lineWidth = lineWidth;
                ctx.beginPath();
                ctx.moveTo(fromX, fromY);
                ctx.lineTo(toX, toY);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(toX, toY);
                ctx.lineTo(toX - headLength * Math.cos(angle - Math.PI / 6), toY - headLength * Math.sin(angle - Math.PI / 6));
                ctx.lineTo(toX - headLength * Math.cos(angle + Math.PI / 6), toY - headLength * Math.sin(angle + Math.PI / 6));
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            }

            // --- Main Drawing Function ---
            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw Dotted Circular Path History
                ctx.save();
                ctx.strokeStyle = '#d1d5db'; // cool-gray-300 (lighter)
                ctx.lineWidth = 2;
                ctx.setLineDash([2, 5]);
                ctx.beginPath();
                if (circularPathHistory.length > 0) {
                    ctx.moveTo(circularPathHistory[0].x, circularPathHistory[0].y);
                    for (let i = 1; i < circularPathHistory.length; i++) {
                        ctx.lineTo(circularPathHistory[i].x, circularPathHistory[i].y);
                    }
                }
                ctx.stroke();
                ctx.restore();

                // Draw Dotted Release Path History
                ctx.save();
                ctx.strokeStyle = '#94a3b8'; // slate-400
                ctx.lineWidth = 2;
                ctx.setLineDash([2, 5]);
                ctx.beginPath();
                if (pathHistory.length > 0) {
                    ctx.moveTo(pathHistory[0].x, pathHistory[0].y);
                    for (let i = 1; i < pathHistory.length; i++) {
                        ctx.lineTo(pathHistory[i].x, pathHistory[i].y);
                    }
                }
                ctx.stroke();
                ctx.restore();

                // Draw center point
                ctx.beginPath();
                ctx.arc(center.x, center.y, 5, 0, Math.PI * 2);
                ctx.fillStyle = '#64748b'; // slate-500
                ctx.fill();

                // Calculate Ball Position
                let currentBallX, currentBallY;

                if (isReleased) {
                    currentBallX = ball.x;
                    currentBallY = ball.y;
                } else {
                    currentBallX = center.x + radius * Math.cos(angle);
                    currentBallY = center.y + radius * Math.sin(angle);
                }

                // Draw the string
                if (!isReleased) {
                    ctx.beginPath();
                    ctx.moveTo(center.x, center.y);
                    ctx.lineTo(currentBallX, currentBallY);
                    ctx.strokeStyle = '#475569'; // slate-600
                    ctx.lineWidth = 2;
                    ctx.stroke();
                }

                // Draw the Ball
                ctx.beginPath();
                ctx.arc(currentBallX, currentBallY, ballRadius, 0, Math.PI * 2);
                ctx.fillStyle = '#3b82f6'; // blue-500
                ctx.fill();
                ctx.strokeStyle = '#2563eb';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Draw Force and Velocity Vectors
                if (!isReleased) {
                    const arrowScale = 0.5 * ballRadius; 

                    // Centripetal Force (Red)
                    drawArrow(currentBallX, currentBallY, center.x, center.y, '#dc2626');

                    // Tangential Velocity (Green)
                    const vx = -radius * angularVelocity * Math.sin(angle);
                    const vy = radius * angularVelocity * Math.cos(angle);
                    drawArrow(currentBallX, currentBallY, currentBallX + vx * arrowScale, currentBallY + vy * arrowScale, '#16a34a');
                }
            }

            // --- Animation Loop ---
            function animate() {
                let currentPos;
                if (isReleased) {
                    // Update ball position for linear motion
                    ball.x += ball.vel.x;
                    ball.y += ball.vel.y;
                    currentPos = { x: ball.x, y: ball.y };
                    pathHistory.push(currentPos);
                    // Keep path history from getting too large
                    if (pathHistory.length > 300) {
                        pathHistory.shift();
                    }

                    // Stop if ball goes off screen
                    if (ball.x < -ballRadius || ball.x > canvas.width + ballRadius ||
                        ball.y < -ballRadius || ball.y > canvas.height + ballRadius) {
                        simRunning = false;
                        cancelAnimationFrame(animFrameId);
                    }
                } else {
                    // Update angle for circular motion
                    angle += angularVelocity;
                    currentPos = {
                        x: center.x + radius * Math.cos(angle),
                        y: center.y + radius * Math.sin(angle)
                    };
                    circularPathHistory.push(currentPos);
                    // Keep circular path history from getting too large (approx 1 full circle)
                    if (circularPathHistory.length > 350) {
                        circularPathHistory.shift();
                    }
                }
                
                draw();

                if (simRunning) {
                    animFrameId = requestAnimationFrame(animate);
                }
            }
            
            // --- Event Handlers ---
            function handleRelease() {
                if (isReleased) return; 

                isReleased = true;
                releaseButton.disabled = true; 

                // Capture current tangential velocity
                const currentBallX = center.x + radius * Math.cos(angle);
                const currentBallY = center.y + radius * Math.sin(angle);
                
                ball.x = currentBallX;
                ball.y = currentBallY;
                
                const velocityMagnitude = radius * angularVelocity * 4; // Slower release speed
                ball.vel.x = -Math.sin(angle) * velocityMagnitude;
                ball.vel.y = Math.cos(angle) * velocityMagnitude;

                // Clear path history on release to show the new straight path clearly
                pathHistory = [{ x: ball.x, y: ball.y }];

                if (!simRunning) {
                    simRunning = true;
                    animate();
                }
            }

            function handleReset() {
                isReleased = false;
                simRunning = true; 
                angle = Math.PI / 4; 
                releaseButton.disabled = false;
                pathHistory = []; // Clear path history
                circularPathHistory = []; // Clear circular path history
                cancelAnimationFrame(animFrameId); 
                animate(); 
            }

            // --- Modal and Gemini API Logic ---

            function showModal() {
                modal.style.display = 'flex';
            }

            function hideModal() {
                modal.style.display = 'none';
            }

            async function handleExplainClick() {
                showModal();
                modalContent.innerHTML = '<div class="loader"></div><p class="text-center text-slate-600">Loading explanation...</p>';
                
                let userPrompt = "";
                const systemPrompt = "You are a friendly physics tutor. Explain the concept in a simple, clear, and encouraging way for a high school student. Use 1-2 paragraphs and bullet points if helpful.";

                if (isReleased) {
                    userPrompt = `My simulation shows a ball that was spinning in a circle and was just released. It's now flying off in a straight line. 
                    
                    Please explain:
                    1. Why does the ball fly off in a straight line?
                    2. Why doesn't it fly straight outwards (away from the center) or keep curving?
                    3. What physics principle (like Inertia) causes this?`;
                } else {
                    userPrompt = `My simulation shows a ball on a string spinning in a circle. I see two arrows: one pointing in (Centripetal Force) and one pointing sideways (Tangential Velocity).

                    Please explain:
                    1. What is Centripetal Force and what is providing it in this case?
                    2. What is Tangential Velocity?
                    3. How do these two things work together to make the ball move in a circle?`;
                }

                try {
                    const response = await callGeminiAPI(userPrompt, systemPrompt);
                    modalContent.innerHTML = `<div class="prose prose-slate max-w-none">${response}</div>`;
                } catch (error) {
                    console.error("Gemini API call failed:", error);
                    modalContent.innerHTML = '<p class="text-red-600">Sorry, I couldn\'t get an explanation right now. Please check your console for errors and try again.</p>';
                }
            }

            /**
             * Calls the Gemini API with exponential backoff.
             * @param {string} userPrompt The user's question.
             * @param {string} systemPrompt The system instruction for the model.
             * @returns {Promise<string>} The generated text response.
             */
            async function callGeminiAPI(userPrompt, systemPrompt) {
                const apiKey = ""; // Leave empty
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

                const payload = {
                    contents: [{ parts: [{ text: userPrompt }] }],
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                };

                let retries = 3;
                let delay = 1000;

                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();
                        
                        if (result.candidates && result.candidates[0].content?.parts?.[0]?.text) {
                            // Simple conversion of markdown-like text to HTML for display
                            let text = result.candidates[0].content.parts[0].text;
                            text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>'); // Bold
                            text = text.replace(/\*(.*?)\*/g, '<em>$1</em>'); // Italics
                            text = text.replace(/(\n\s*){2,}/g, '<br><br>'); // Paragraphs
                            text = text.replace(/\n(\d\.)/g, '<br>$1'); // Numbered lists
                            text = text.replace(/\n\*/g, '<br>‚Ä¢'); // Bullet points
                            return text;
                        } else {
                            throw new Error("Invalid API response structure");
                        }

                    } catch (error) {
                        console.warn(`API call attempt ${i + 1} failed. Retrying in ${delay}ms...`, error);
                        if (i === retries - 1) {
                            throw error; // Last retry failed, re-throw
                        }
                        await new Promise(res => setTimeout(res, delay));
                        delay *= 2; // Exponential backoff
                    }
                }
            }


            // --- Initialization ---
            releaseButton.addEventListener('click', handleRelease);
            resetButton.addEventListener('click', handleReset);
            explainButton.addEventListener('click', handleExplainClick);
            closeModalButton.addEventListener('click', hideModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    hideModal(); // Close if clicking on the background overlay
                }
            });
            
            window.addEventListener('resize', resizeCanvas);
            
            resizeCanvas(); 
            animate(); 
        });

        function openFeedbackForm(e) {
            e.preventDefault();
            document.getElementById('feedbackModal').classList.remove('hidden');
        }
        function closeFeedbackForm() {
            document.getElementById('feedbackModal').classList.add('hidden');
        }
        async function submitFeedback(e) {
            e.preventDefault();
            const form = e.target;
            const email = form.querySelector('input[type="email"]').value;
            const message = form.querySelector('textarea').value;
            
            try {
                const response = await fetch('https://formspree.io/f/mnjzeogj', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, message })
                });
                if (response.ok) {
                    alert('Thank you for your feedback!');
                    closeFeedbackForm();
                    form.reset();
                } else {
                    alert('Error sending feedback. Please try again.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error sending feedback.');
            }
        }
    </script>

    <!-- Language Translation System -->
    <script>
        const translations = {
            en: {
                'nav.back': 'Back to Home',
                'title': 'Ball & String Simulator',
                'subtitle': "Observe the ball's path when the string is released!",
                'button.release': 'Release Ball!',
                'button.reset': 'Reset',
                'button.explain': '‚ú® Explain the Physics',
                'info.red': 'Red Arrow',
                'info.red.desc': 'Centripetal Force (tension in the string)',
                'info.green': 'Green Arrow',
                'info.green.desc': 'Tangential Velocity (direction of motion)',
                'info.watch': 'Watch how the ball continues to move in the direction of the **green arrow** (tangential velocity) at the exact moment of release!',
                'button.feedback': 'üìù Send us your feedback',
                'feedback.title': 'Send Us Your Feedback',
                'feedback.email': 'Your email',
                'feedback.message': 'Your feedback or suggestions...',
                'feedback.send': 'Send',
                'feedback.cancel': 'Cancel',
                'feedback.thanks': 'Thank you for your feedback!',
                'feedback.error': 'Error sending feedback. Please try again.'
            },
            zh: {
                'nav.back': 'ËøîÂõûÈ¶ñÈ†Å',
                'title': 'ÁêÉËàáÁπ©Ê®°Êì¨Âô®',
                'subtitle': 'ËßÄÂØüÁπ©Â≠êÊîæÊâãÊôÇÁêÉÁöÑË∑ØÂæëÔºÅ',
                'button.release': 'ÊîæÈñãÁêÉÔºÅ',
                'button.reset': 'ÈáçË®≠',
                'button.explain': '‚ú® Ëß£ÈáãÁâ©ÁêÜÂéüÁêÜ',
                'info.red': 'Á¥ÖËâ≤ÁÆ≠È†≠',
                'info.red.desc': 'ÂêëÂøÉÂäõÔºàÁπ©Â≠êÂºµÂäõÔºâ',
                'info.green': 'Á∂†Ëâ≤ÁÆ≠È†≠',
                'info.green.desc': 'ÂàáÁ∑öÈÄüÂ∫¶ÔºàÈÅãÂãïÊñπÂêëÔºâ',
                'info.watch': 'ËßÄÂØüÁêÉÂú®ÊîæÊâãÁöÑÁû¨ÈñìÂ¶Ç‰ΩïÊ≤øËëó**Á∂†Ëâ≤ÁÆ≠È†≠**ÔºàÂàáÁ∑öÈÄüÂ∫¶ÔºâÁöÑÊñπÂêëÁπºÁ∫åÁßªÂãïÔºÅ',
                'button.feedback': 'üìù ÁôºÈÄÅÂèçÈ•ã',
                'feedback.title': 'ÁôºÈÄÅÊÇ®ÁöÑÂèçÈ•ã',
                'feedback.email': 'ÊÇ®ÁöÑÈõªÂ≠êÈÉµ‰ª∂',
                'feedback.message': 'ÊÇ®ÁöÑÂèçÈ•ãÊàñÂª∫Ë≠∞...',
                'feedback.send': 'ÁôºÈÄÅ',
                'feedback.cancel': 'ÂèñÊ∂à',
                'feedback.thanks': 'ÊÑüË¨ùÊÇ®ÁöÑÂèçÈ•ãÔºÅ',
                'feedback.error': 'ÁôºÈÄÅÂèçÈ•ãÊôÇÂá∫ÈåØ„ÄÇË´ãÈáçË©¶„ÄÇ'
            },
            cn: {
                'nav.back': 'ËøîÂõûÈ¶ñÈ°µ',
                'title': 'ÁêÉ‰∏éÁª≥Ê®°ÊãüÂô®',
                'subtitle': 'ËßÇÂØüÁª≥Â≠êÊîæÊâãÊó∂ÁêÉÁöÑË∑ØÂæÑÔºÅ',
                'button.release': 'ÊîæÂºÄÁêÉÔºÅ',
                'button.reset': 'ÈáçËÆæ',
                'button.explain': '‚ú® Ëß£ÈáäÁâ©ÁêÜÂéüÁêÜ',
                'info.red': 'Á∫¢Ëâ≤ÁÆ≠Â§¥',
                'info.red.desc': 'ÂêëÂøÉÂäõÔºàÁª≥Â≠êÂº†ÂäõÔºâ',
                'info.green': 'ÁªøËâ≤ÁÆ≠Â§¥',
                'info.green.desc': 'ÂàáÁ∫øÈÄüÂ∫¶ÔºàËøêÂä®ÊñπÂêëÔºâ',
                'info.watch': 'ËßÇÂØüÁêÉÂú®ÊîæÊâãÁöÑÁû¨Èó¥Â¶Ç‰ΩïÊ≤øÁùÄ**ÁªøËâ≤ÁÆ≠Â§¥**ÔºàÂàáÁ∫øÈÄüÂ∫¶ÔºâÁöÑÊñπÂêëÁªßÁª≠ÁßªÂä®ÔºÅ',
                'button.feedback': 'üìù ÂèëÈÄÅÂèçÈ¶à',
                'feedback.title': 'ÂèëÈÄÅÊÇ®ÁöÑÂèçÈ¶à',
                'feedback.email': 'ÊÇ®ÁöÑÁîµÂ≠êÈÇÆ‰ª∂',
                'feedback.message': 'ÊÇ®ÁöÑÂèçÈ¶àÊàñÂª∫ËÆÆ...',
                'feedback.send': 'ÂèëÈÄÅ',
                'feedback.cancel': 'ÂèñÊ∂à',
                'feedback.thanks': 'ÊÑüË∞¢ÊÇ®ÁöÑÂèçÈ¶àÔºÅ',
                'feedback.error': 'ÂèëÈÄÅÂèçÈ¶àÊó∂Âá∫Èîô„ÄÇËØ∑ÈáçËØï„ÄÇ'
            }
        };

        let currentLang = localStorage.getItem('preferred_language') || 'en';

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('preferred_language', lang);
            
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });

            // Update placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[lang] && translations[lang][key]) {
                    el.placeholder = translations[lang][key];
                }
            });
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('bg-blue-600', 'text-white');
                    btn.classList.remove('text-slate-600');
                } else {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('text-slate-600');
                }
            });
            
            document.documentElement.lang = lang === 'cn' ? 'zh-CN' : lang === 'zh' ? 'zh-TW' : 'en';
        }

        window.addEventListener('DOMContentLoaded', () => {
            setLanguage(currentLang);
        });
    </script>

</body>
</html>
